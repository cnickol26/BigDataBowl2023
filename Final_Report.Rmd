---
title: "Evaluating Offensive Tackles with Bayesian Methods"
author: 'Josh Gen (jdg9vr@virginia.edu) and Connor Nickol (can2hr@virginia.edu)'
date: "Big Data Bowl 2023: Metric Track"
output: 
  html_document:
    number_sections: true
    toc: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(knitr)
```

# Introduction

Offensive linemen provide key value in a football game, which often goes unnoticed on box scores and game logs. While there are plenty of metrics and statistics for ball-handlers and defenders, there are not many commonly used statistics to evaluate offensive linemen.

We create a novel scoring system for offensive linemen based on the type of rush they encounter. We note the need for different models for different rush types, as they significantly affect the evaluation of the offensive lineman on that play.

We identify two common rushing techniques employed by defensive ends: bull/power rush (hereby referred to as power rush) and speed rush. A speed rush, as identified in Figure 1 below, is a rush in which the defender attempts to speed around the lineman and reach the quarterback before the lineman for a sack.

![**Figure 1**: Myles Garrett, circled in red, engaging in a speed rush](./Visuals/speedrush.gif)

A power rush, demonstrated in Figure 2 below, occurs when the defender attempts to overpower the lineman by pushing them back, eventually reaching and sacking the quarterback.

![**Figure 2**: Myles Garrett, circled in red, engaging in a power rush](./Visuals/powerrush.gif)

The figures above make it clear that offensive linemen must be assessed differently for speed and power rushes. For blocking against speed rushing, the key for a lineman is to have a quick "get-off time", or time to move back from their initial position on the line of scrimmage. The first couple moments of the play are crucial when the edge rusher is speed rushing, as the offensive lineman must move back far enough and quick enough to block a defender attempting to get around the lineman. For power rushing, the key for the lineman is to not allow the defender to overpower them, or not give up any distance to the quarterback. Against power rushing, a lineman is successful if they do not allow the rusher to push them back towards the quarterback. This will be more formally defined in the following section.

# Methods

We seek to model the performance of offensive tackles by first modeling the defender's rush type (speed or power), then modeling individual tackle performance, holding all other important factors constant. We chose to focus only on offensive tackles and not evaluate other positions because their blocking can often be more isolated from the center and guards, and double teams and stunts are less common for tackles. At a high level, our project methods can be viewed in three phases: data cleaning, speed vs. power modeling, and individual offensive tackle modeling.

## Data Cleaning

Using the expansive, eight-week NFL player tracking data, we first cleaned and filtered the data. We removed the following events from the data for our analysis:

  - Chip blocks
  - QB scrambles
  - Non-standard QB dropbacks
  - All positions other than QBs, tackles, and edge rusher
  - Edge rushers who were also in coverage
  - Edge rushers who disengaged with the tackle (stunt block or other)

Note that a chip block occurs when the running back or tight end "chips" the defender, aiding the lineman, before running their route, thereby aiding them in blocking the defender. Each of these events change the interaction between the lineman and the defender, and would skew our model if left in. We also flipped the position of the right tackles and left ends around the ball so all the tackle-end interactions are on a similar path and direction for modeling. 

## Speed vs. Power Rush Modeling

Once the data was prepared, we turned to creating a model to determine whether a specific rush was a speed or power rush. Because there was no label in the data for rush type, this would require an unsupervised model. As a means of evaluating performance of the model, we randomly selected 10 plays, watched the game film, and labeled the rush type for each edge rusher (20 rushers) to create test data. We created four variables for each rush for our models to use in determining rush type:

  1. Mean_tackle_end_dist: Average distance between the tackle and edge rusher on the play
  2. Mean_tackle_end_facing: Average difference between the angle of tackle and rusher (0 is facing each other, 180 is facing in opposite directions)
  3. End_dist_travel: Total distance traveled by the edge rusher
  4. Mean_end_speed: Average speed of the edge rusher during the play

```{r}
table <- data.frame(Rush_Type=c("Power", "Speed"),
                    Mean_tackle_end_dist=c(1.16615885, 1.15544887),
                    Mean_tackle_end_facing=c(26.1976727, 61.32940427),
                    End_dist_travel = c(7.27401843, 9.67472515),
                    Mean_end_speed = c(2.78494659, 2.98266389))

kable(table)
```

We created a k-means clustering model as well (both performed similarly on our test data but GMM gives probability of belonging in each class)


Remove plays where the model was less than 55% confident in its prediction

## Bayesian Hierarchical Model

# Results

# Discussion

Our analysis could certainly be extended to centers and guards, but some important changes would be required. Could compare our analysis with salary data, though we are not analzying overall performance.



